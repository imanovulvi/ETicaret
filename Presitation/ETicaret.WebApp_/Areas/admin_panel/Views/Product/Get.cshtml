
@model VM_Product_Get
@{
    ViewData["Title"] = "Index";
}

<h1>Index</h1>
<div class="container">
<a class="btn btn-primary create" href="#" role="button" data-bs-toggle="modal" data-bs-target="#exampleModalCreate">Create</a>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Name</th>
            <th>Price</th>
            <th>Stock</th>
            <th>CreateDate</th>
            <th>UpdateDate</th>
            <th>Update</th>
            <th>Deleted</th>
        </tr>
        
    </thead>
    <tbody>
        @foreach (Product item in Model.Products)
        {
            <tr>
                <td>@item.Name</td>
                <td>@item.Price</td>
                <td>@item.Stock</td>
                <td>@item.CreateDate</td>
                <td>@item.UpdateDate</td>
                <td><a class="btn btn-primary" href="/admin_panel/Product/Update/@item.Id" role="button">Update</a></td>
                <td>
                    <a class="btn btn-danger deleted" href="#" data-id="@item.Id" role="button" data-bs-toggle="modal" data-bs-target="#exampleModalDeleted">Del</a>
                
                    </td>
            </tr>
        }
    </tbody>
</table>
    <nav aria-label="Page navigation example">
        <ul class="pagination">
            @{
                int count=Model.Count % 5 == 0 ? Model.Count/5 : (Model.Count/5)+1;
                for (int i = 0; i < count; i++)
                {
                    <li class="page-item"><a class="page-link pagination" href="/admin_panel/Product/Get?page=@(i+1)&&size=5">@(i + 1)</a></li>
                }
           }
            
       
        </ul>
    </nav>

</div>
<!-- Deleted Modal -->
<div class="modal fade" id="exampleModalDeleted" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Deleted</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary deleted_modal">Deleted</button>
            </div>
        </div>
    </div>
</div>


<!-- Create Modal -->
<div class="modal fade" id="exampleModalCreate" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Create Product</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>

                                    <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">Name</label>
                                        <input type="text" name="Name" class="form-control" id="exampleFormControlInput1" placeholder="Name">

                                    </div>
                               
                                    <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">Price</label>
                                        <input type="number" name="Price" class="form-control" id="exampleFormControlInput1" placeholder="Price">
                                    </div>
                               
                                    <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">Stock</label>
                                        <input type="number" name="Stock" class="form-control" id="exampleFormControlInput1" placeholder="Stock">
                                    </div>
                                    
                    <input type="submit" class="btn btn-primary create_modal" value="Create" />
                     
                </form>
              
            </div>

        </div>
    </div>
</div>

 @section Scripts
{
    <script src="/lib/jquery/dist/jquery.js" asp-append-version="true"></script>
    <script>
    $(".deleted").click(
        function () {
            var id = $(this).data("id");
                $(".deleted_modal").data("id", id);
        });

        $(".deleted_modal").click(
            function () {
                alert($(this).data("id"));
                $.ajax({
                type:"post",
                    url: "/admin_panel/Product/Deleted/" + $(this).data("id"),
                    success: function () 
                    {
                        window.location.replace("/admin_panel/Product/Get");
                    },
                    error: function () {
                        window.location.replace("/admin_panel/Product/Get");
                    }
                });
            });
    </script>

    <script>
        $(".create_modal").click(function () { 
            $.ajax({
            type:"post",
            url:"/admin_panel/Product/Post",
                success: function () 
                {
                    window.location.replace("/admin_panel/Product/Get");
                },
                error: function () 
                {
                    window.location.replace("/admin_panel/Product/Get");
                }
            });
        
        });
    </script>
}